<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>P了么</title>
    <link rel="stylesheet" href="/styles.css?v=20260112" />
  </head>
  <body>
    <main class="container">
      <header class="header">
        <div class="topbar">
          <div>
            <h1>P了么 - AI 图片生成</h1>
          </div>
          <div class="authTop">
            <div class="authMeta">
              <div id="me" class="me">未登录</div>
              <div id="quota" class="quota"></div>
            </div>
            <div class="authBtns">
              <button id="openLogin" class="secondary" type="button">登录</button>
              <button id="openRegister" class="secondary" type="button">注册</button>
              <button id="logout" class="secondary" type="button" style="display:none">退出</button>
            </div>
          </div>
        </div>
      </header>

      <div id="loginModal" class="modal" hidden>
        <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
          <div class="modalHeader">
            <div id="loginTitle" class="modalTitle">登录</div>
            <button class="iconBtn" type="button" data-close-modal="loginModal" aria-label="关闭">×</button>
          </div>
          <div class="modalBody">
            <div class="row grid2">
              <div>
                <label class="label" for="loginUsername">用户名</label>
                <input id="loginUsername" type="text" autocomplete="username" placeholder="a-z0-9._-" />
              </div>
              <div>
                <label class="label" for="loginPassword">密码</label>
                <input id="loginPassword" type="password" autocomplete="current-password" placeholder="至少 6 位" />
              </div>
            </div>
            <div id="loginError" class="formError" hidden></div>
          </div>
          <div class="modalFooter">
            <button class="secondary" type="button" data-close-modal="loginModal">取消</button>
            <button id="doLogin" class="primary" type="button">登录</button>
          </div>
        </div>
      </div>

      <div id="registerModal" class="modal" hidden>
        <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="registerTitle">
          <div class="modalHeader">
            <div id="registerTitle" class="modalTitle">注册</div>
            <button class="iconBtn" type="button" data-close-modal="registerModal" aria-label="关闭">×</button>
          </div>
          <div class="modalBody">
            <div class="row grid2">
              <div>
                <label class="label" for="registerUsername">用户名</label>
                <input id="registerUsername" type="text" autocomplete="username" placeholder="a-z0-9._-" />
              </div>
              <div>
                <label class="label" for="registerPassword">密码</label>
                <input id="registerPassword" type="password" autocomplete="new-password" placeholder="至少 6 位" />
              </div>
            </div>
            <div class="row">
              <label class="label" for="inviteCode">注册码</label>
              <input id="inviteCode" type="text" autocomplete="off" placeholder="请输入注册码" />
              <div class="hint">注册需要有效的注册码。</div>
            </div>
            <div id="registerError" class="formError" hidden></div>
          </div>
          <div class="modalFooter">
            <button class="secondary" type="button" data-close-modal="registerModal">取消</button>
            <button id="doRegister" class="primary" type="button">注册</button>
          </div>
        </div>
      </div>

      <div id="imageModal" class="modal" hidden>
        <div class="modalCard imageModalCard" role="dialog" aria-modal="true" aria-labelledby="imageTitle">
          <div class="modalHeader">
            <div id="imageTitle" class="modalTitle">预览</div>
            <button class="iconBtn" type="button" data-close-modal="imageModal" aria-label="关闭">×</button>
          </div>
          <div class="modalBody imageViewer">
            <img id="imageModalImg" alt="preview" />
          </div>
          <div class="modalFooter">
            <a id="imageModalOpen" class="secondary" href="#" target="_blank" rel="noreferrer">打开原图</a>
            <button class="secondary" type="button" data-close-modal="imageModal">关闭</button>
          </div>
        </div>
      </div>

      <section class="card" data-auth="required">
        <div class="row">
          <label class="label">选择图片</label>
          <div class="filePicker">
            <input id="images" class="fileInput" type="file" accept="image/*" multiple />
            <label class="fileBtn" for="images">选择图片</label>
            <div id="fileInfo" class="fileInfo">未选择</div>
          </div>
          <div class="hint">可同时选择多张（最多 3 张）。</div>
        </div>

        <div id="preview" class="preview"></div>
        <div id="baseIndexWrap" class="row baseIndex" hidden>
          <div class="baseIndexInner">
            <div class="muted">底图（被修改的那张）</div>
            <select id="baseIndex"></select>
          </div>
          <div class="hint">如果你希望“把第 1 张 P 成第 2 张的效果”，通常应选择底图为第 1 张。</div>
        </div>
      </section>

      <section class="card" data-auth="required">
        <div class="row">
          <div>
            <label class="label" for="n">生成数量（1–6）</label>
            <input id="n" type="number" min="1" max="6" value="2" />
          </div>
        </div>

        <div class="row">
          <label class="label" for="prompt">Prompt</label>
          <textarea id="prompt" rows="5" placeholder="描述你希望生成的效果…"></textarea>
          <div class="effectGroups">
            <div class="effectGroup">
              <div class="effectTitle">影调调整</div>
              <div class="chips">
                <button class="chip" type="button" data-prompt="电影调色">电影调色</button>
                <button class="chip" type="button" data-prompt="日系清透">日系清透</button>
                <button class="chip" type="button" data-prompt="HDR 质感">HDR 质感</button>
                <button class="chip" type="button" data-prompt="暗角">暗角</button>
                <button class="chip" type="button" data-prompt="胶片颗粒">胶片颗粒</button>
                <button class="chip" type="button" data-prompt="色温调整-暖">色温调整-暖</button>
                <button class="chip" type="button" data-prompt="色温调整-冷">色温调整-冷</button>
                <button class="chip" type="button" data-prompt="去噪">去噪</button>
                <button class="chip" type="button" data-prompt="锐化细节">锐化细节</button>
                <button class="chip" type="button" data-prompt="背景虚化">背景虚化</button>
              </div>
            </div>

            <div class="effectGroup">
              <div class="effectTitle">面容调整</div>
              <div class="chips">
                <button class="chip" type="button" data-prompt="肤色校正">肤色校正</button>
                <button class="chip" type="button" data-prompt="去油光">去油光</button>
                <button class="chip" type="button" data-prompt="美白牙齿">美白牙齿</button>
                <button class="chip" type="button" data-prompt="眼神增强">眼神增强</button>
                <button class="chip" type="button" data-prompt="大眼高光">大眼高光</button>
                <button class="chip" type="button" data-prompt="妆容增强">妆容增强</button>
                <button class="chip" type="button" data-prompt="二次元柔光">二次元柔光</button>
                <button class="chip" type="button" data-prompt="头发飘逸">头发飘逸</button>
              </div>
              <div class="faceControls">
                <label class="check">
                  <input id="faceRedraw" type="checkbox" />
                  <span>面部重绘</span>
                </label>
                <div class="strength">
                  <span class="muted">重绘程度</span>
                  <input id="faceStrength" type="range" min="1" max="5" value="3" />
                  <span id="faceStrengthValue" class="badge">3</span>
                </div>
              </div>
            </div>

            <div class="effectGroup">
              <div class="effectTitle">环境调整</div>
              <div class="chips">
                <button class="chip" type="button" data-prompt="闪电效果">闪电效果</button>
                <button class="chip" type="button" data-prompt="武器发光">武器发光</button>
                <button class="chip" type="button" data-prompt="火焰特效">火焰特效</button>
                <button class="chip" type="button" data-prompt="能量光环">能量光环</button>
                <button class="chip" type="button" data-prompt="霓虹光效">霓虹光效</button>
                <button class="chip" type="button" data-prompt="粒子效果">粒子效果</button>
                <button class="chip" type="button" data-prompt="烟雾效果">烟雾效果</button>
                <button class="chip" type="button" data-prompt="体积光">体积光</button>
                <button class="chip" type="button" data-prompt="逆光轮廓光">逆光轮廓光</button>
                <button class="chip" type="button" data-prompt="光斑漏光">光斑漏光</button>
                <button class="chip" type="button" data-prompt="雨天氛围">雨天氛围</button>
                <button class="chip" type="button" data-prompt="雪花效果">雪花效果</button>
                <button class="chip" type="button" data-prompt="尘埃粒子">尘埃粒子</button>
                <button class="chip" type="button" data-prompt="舞台灯光">舞台灯光</button>
                <button class="chip" type="button" data-prompt="舞台光晕">舞台光晕</button>
                <button class="chip" type="button" data-prompt="彩灯散景">彩灯散景</button>
                <button class="chip" type="button" data-prompt="樱花氛围">樱花氛围</button>
                <button class="chip" type="button" data-prompt="星光闪粉">星光闪粉</button>
                <button class="chip" type="button" data-prompt="速度线">速度线</button>
                <button class="chip" type="button" data-prompt="去路人">去路人</button>
                <button class="chip" type="button" data-prompt="背景简化">背景简化</button>
                <button class="chip" type="button" data-prompt="漫展补光">漫展补光</button>
                <button class="chip" type="button" data-prompt="去反光">去反光</button>
                <button class="chip" type="button" data-prompt="服装质感">服装质感</button>
                <button class="chip" type="button" data-prompt="假发发丝修复">假发发丝修复</button>
                <button class="chip" type="button" data-prompt="降摩尔纹">降摩尔纹</button>
                <button class="chip" type="button" data-prompt="漫画线稿">漫画线稿</button>
                <button class="chip" type="button" data-prompt="赛璐璐光影">赛璐璐光影</button>
                <button class="chip" type="button" data-prompt="漫画网点">漫画网点</button>
              </div>
            </div>
          </div>
          <div class="hint">点击上方按钮会自动追加预设 prompt 片段。</div>
        </div>

        <div class="row">
          <label class="check">
            <input id="hd" type="checkbox" />
            <span>超清</span>
          </label>
          <div class="hint">勾选后会按输入图片比例，将输出尺寸最长边提升到 2048px。</div>
        </div>

        <div class="row actions">
          <button id="submit" class="primary" type="button">开始生成</button>
          <button id="clear" class="secondary" type="button">清空</button>
          <div id="status" class="status"></div>
        </div>
      </section>

      <section class="card" data-auth="required">
        <h2 class="h2">输出结果</h2>
        <div id="results" class="results"></div>
      </section>

      <footer class="footer">
        <div>提示：点击【生成】按钮后，请耐心等到，一般 1min 内可生成</div>
      </footer>
    </main>

    <script src="/app.js?v=20260112"></script>
  </body>
</html>
