<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI 图片生成</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="container">
      <header class="header">
        <div class="topbar">
          <div>
            <h1>AI 图片生成</h1>
          </div>
          <div class="authTop">
            <div class="authMeta">
              <div id="me" class="me">未登录</div>
              <div id="quota" class="quota"></div>
            </div>
            <div class="authBtns">
              <button id="openLogin" class="secondary" type="button">登录</button>
              <button id="openRegister" class="secondary" type="button">注册</button>
              <button id="logout" class="secondary" type="button" style="display:none">退出</button>
            </div>
          </div>
        </div>
      </header>

      <div id="loginModal" class="modal" hidden>
        <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
          <div class="modalHeader">
            <div id="loginTitle" class="modalTitle">登录</div>
            <button class="iconBtn" type="button" data-close-modal="loginModal" aria-label="关闭">×</button>
          </div>
          <div class="modalBody">
            <div class="row grid2">
              <div>
                <label class="label" for="loginUsername">用户名</label>
                <input id="loginUsername" type="text" autocomplete="username" placeholder="a-z0-9._-" />
              </div>
              <div>
                <label class="label" for="loginPassword">密码</label>
                <input id="loginPassword" type="password" autocomplete="current-password" placeholder="至少 6 位" />
              </div>
            </div>
            <div id="loginError" class="formError" hidden></div>
          </div>
          <div class="modalFooter">
            <button class="secondary" type="button" data-close-modal="loginModal">取消</button>
            <button id="doLogin" class="primary" type="button">登录</button>
          </div>
        </div>
      </div>

      <div id="registerModal" class="modal" hidden>
        <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="registerTitle">
          <div class="modalHeader">
            <div id="registerTitle" class="modalTitle">注册</div>
            <button class="iconBtn" type="button" data-close-modal="registerModal" aria-label="关闭">×</button>
          </div>
          <div class="modalBody">
            <div class="row grid2">
              <div>
                <label class="label" for="registerUsername">用户名</label>
                <input id="registerUsername" type="text" autocomplete="username" placeholder="a-z0-9._-" />
              </div>
              <div>
                <label class="label" for="registerPassword">密码</label>
                <input id="registerPassword" type="password" autocomplete="new-password" placeholder="至少 6 位" />
              </div>
            </div>
            <div class="row">
              <label class="label" for="inviteCode">注册码</label>
              <input id="inviteCode" type="text" autocomplete="off" placeholder="请输入注册码" />
              <div class="hint">注册需要有效的注册码。</div>
            </div>
            <div id="registerError" class="formError" hidden></div>
          </div>
          <div class="modalFooter">
            <button class="secondary" type="button" data-close-modal="registerModal">取消</button>
            <button id="doRegister" class="primary" type="button">注册</button>
          </div>
        </div>
      </div>

      <section class="card" data-auth="required">
        <div class="row">
          <label class="label" for="images">选择图片</label>
          <input id="images" type="file" accept="image/*" multiple />
          <div class="hint">最多选择 6 张输入图片。</div>
        </div>

        <div id="preview" class="preview"></div>
      </section>

      <section class="card" data-auth="required">
        <div class="row">
          <div>
            <label class="label" for="n">生成数量（1–6）</label>
            <input id="n" type="number" min="1" max="6" value="2" />
          </div>
        </div>

        <div class="row">
          <label class="label" for="prompt">Prompt</label>
          <textarea id="prompt" rows="5" placeholder="描述你希望生成的效果…"></textarea>
          <div class="chips">
            <button class="chip" type="button" data-prompt="粒子效果">粒子效果</button>
            <button class="chip" type="button" data-prompt="头发飘逸">头发飘逸</button>
            <button class="chip" type="button" data-prompt="闪电效果">闪电效果</button>
            <button class="chip" type="button" data-prompt="烟雾效果">烟雾效果</button>
            <button class="chip" type="button" data-prompt="武器发光">武器发光</button>
            <button class="chip" type="button" data-prompt="火焰特效">火焰特效</button>
            <button class="chip" type="button" data-prompt="能量光环">能量光环</button>
            <button class="chip" type="button" data-prompt="霓虹光效">霓虹光效</button>
            <button class="chip" type="button" data-prompt="电影调色">电影调色</button>
            <button class="chip" type="button" data-prompt="背景虚化">背景虚化</button>
            <button class="chip" type="button" data-prompt="锐化细节">锐化细节</button>
            <button class="chip" type="button" data-prompt="去噪">去噪</button>
            <button class="chip" type="button" data-prompt="二次元柔光">二次元柔光</button>
            <button class="chip" type="button" data-prompt="大眼高光">大眼高光</button>
            <button class="chip" type="button" data-prompt="漫画线稿">漫画线稿</button>
            <button class="chip" type="button" data-prompt="赛璐璐光影">赛璐璐光影</button>
            <button class="chip" type="button" data-prompt="舞台灯光">舞台灯光</button>
            <button class="chip" type="button" data-prompt="樱花氛围">樱花氛围</button>
            <button class="chip" type="button" data-prompt="星光闪粉">星光闪粉</button>
            <button class="chip" type="button" data-prompt="日系清透">日系清透</button>
            <button class="chip" type="button" data-prompt="漫画网点">漫画网点</button>
            <button class="chip" type="button" data-prompt="速度线">速度线</button>
          </div>
          <div class="faceControls">
            <label class="check">
              <input id="faceRedraw" type="checkbox" />
              <span>面部重绘</span>
            </label>
            <div class="strength">
              <span class="muted">重绘程度</span>
              <input id="faceStrength" type="range" min="1" max="5" value="3" />
              <span id="faceStrengthValue" class="badge">3</span>
            </div>
          </div>
          <div class="hint">点击上方按钮会自动追加预设 prompt 片段。</div>
        </div>

        <div class="row actions">
          <button id="submit" class="primary" type="button">开始生成</button>
          <button id="clear" class="secondary" type="button">清空</button>
          <div id="status" class="status"></div>
        </div>
      </section>

      <section class="card" data-auth="required">
        <h2 class="h2">输出结果</h2>
        <div id="results" class="results"></div>
      </section>

      <footer class="footer">
        <div>提示：服务端需要配置 <code>DASHSCOPE_API_KEY</code>；并确保 OSS 配置可用。</div>
      </footer>
    </main>

    <script src="/app.js"></script>
  </body>
</html>
